import { Meta } from '@storybook/blocks';
import { BackToTopButton } from '../../components';

<BackToTopButton />

<Meta title="Native UI / Guides / Migrating from UW Native UI" />

# Migration Guide

This guide is intended to help you migrate from our old React Native UI library, UW Native UI (`@utilitywarehouse/uw-native-ui`)
to Native UI (`@utilitywarehouse/native-ui`). Although you can use both libraries in the same project, it is recommended that you
migrate to Native UI as UW Native UI is deprecated.

- [Key Info](#key-info)
- [Migration Steps](#migration-steps)
  - [Components](#components)
    - [`Button`](#button)
    - [`Typography`](#typography)
    - [`ThemeProvider`](#themeprovider)
  - [Styles](#styles)
    - [`StyleSheet`](#stylesheet)
    - [Dark Mode](#dark-mode)
  - [Fonts](#fonts)
  - [Colours](#colours)
- [Known Issues](#known-issues)
  - [`TypeError: Cannot read property 'x' of undefined`](#typeerror-cannot-read-property-x-of-undefined)
- [Support](#support)

## Key Info

- UW Native UI: `@utilitywarehouse/uw-native-ui` - [Repo](https://github.com/utilitywarehouse/uw-native-ui)
- Native UI: `@utilitywarehouse/native-ui` - [Repo](https://github.com/utilitywarehouse/design-systems/tree/main/packages/native-ui)

- `@utilitywarehouse/uw-native-ui` is deprecated and will not receive any updates.
- `@utilitywarehouse/native-ui` is the new library and will receive updates and new features.
- `@utilitywarehouse/native-ui` is a complete rewrite of `@utilitywarehouse/uw-native-ui` and has a different API.
- `@utilitywarehouse/uw-native-ui` uses `react-native-paper` under the hood.
- `@utilitywarehouse/native-ui` uses `gluestack-ui` under the hood for some component logic.
- `@utilitywarehouse/native-ui` uses `react-native-unistyles` for styling.

## Migration Steps

### Components

Not all components from `@utilitywarehouse/uw-native-ui` have a 1:1 mapping to `@utilitywarehouse/native-ui`.
Below are the steps to replace the components.

#### `Alert`

Replace all `Alert` components from `@utilitywarehouse/uw-native-ui` with `@utilitywarehouse/native-ui`.

```tsx
- import { Alert, Typography } from '@utilitywarehouse/uw-native-ui';
- import InfoIcon from '@utilitywarehouse/partner-ui-icons/lib/InfoOutlined.svg';
+ import { Alert } from '@utilitywarehouse/native-ui';

...

- <Alert variant="error" icon={() => <InfoIcon style={styles.icon} />}>
-   <Typography style={styles.text} variant="bodyHighlight">Title</Typography>
-   <Typography style={styles.text} variant="body">Message</Typography>
- </Alert>
+ <Alert
+   colorScheme="red"
+   title="Title"
+   text="Message"
+ />
```

| Prop Before | Prop After                 | Values                                                                                       |
| ----------- | -------------------------- | -------------------------------------------------------------------------------------------- |
| `variant`   | `colorSchene`              | `error` -> `red` <br/> `warning` -> `gold` <br/> `info` -> `blue` <br/> `success` -> `green` |
| `onPress`   | `onPressIconButton`        | -                                                                                            |
| `icon`      | - (handled by colorScheme) | -                                                                                            |
| -           | `title`                    | -                                                                                            |
| -           | `text`                     | -                                                                                            |

For more info see the [Alert](/docs/native-ui-components-alert--docs) documentation.

#### `Badge`

Replace all `Badge` components from `@utilitywarehouse/uw-native-ui` with `@utilitywarehouse/native-ui`.

```tsx
- import { Badge } from '@utilitywarehouse/uw-native-ui';
+ import { Badge } from '@utilitywarehouse/native-ui';

...

- <Badge colourScheme="red" text="Error" strong={true} size="small" bottomBorderless={true} />
+ <Badge colorScheme="red" strong size="small" borderless>Error</Badge>
```

| Prop Before               | Prop After    | Values                                                                                                       |
| ------------------------- | ------------- | ------------------------------------------------------------------------------------------------------------ |
| `colourScheme`            | `colorScheme` | `red` -> `red` <br/> `cyan` -> `cyan` <br/> `gold` -> `gold` <br/> `grey` -> `grey` <br/> `green` -> `green` |
| `text`                    | `children`    | The text is now passed as children                                                                           |
| `bottomBorderless`        | `borderless`  | `true` \| `false`                                                                                            |
| `textColorOverride`       | n/a           | Use the styling API for custom text styling                                                                  |
| `backgroundColorOverride` | n/a           | Use the styling API for custom background styling                                                            |

For more advanced customisation of the `Badge` text, you can use the component parts:

```tsx
- import { Badge, Typography } from '@utilitywarehouse/uw-native-ui';
+ import { Badge, BadgeText } from '@utilitywarehouse/native-ui';

...

- <Badge colourScheme="red" text="Error" />
+ <Badge colorScheme="red" style={styles.badge}>
+   <BadgeText style={styles.badgeText}>Error</BadgeText>
+ </Badge>
```

For more info see the [Badge](/docs/native-ui-components-badge--docs) documentation.

#### `Button`

Replace all `Button` components from `@utilitywarehouse/uw-native-ui` with `@utilitywarehouse/native-ui`.

```tsx
- import { Button } from '@utilitywarehouse/uw-native-ui';
+ import { Button } from '@utilitywarehouse/native-ui';

...

- <Button onPress={handleClick}>Click me</Button>
+ <Button onPress={handleClick}>Click me</Button>
```

| Prop Before            | Prop After     | Values                                                                       |
| ---------------------- | -------------- | ---------------------------------------------------------------------------- |
| `mode`                 | `variant`      | `contained` -> `solid` <br/> `outlined` -> `outline` <br/> `text` -> `ghost` |
| `size`                 | `size`         | `small` -> `small` <br/> `normal` -> `medium` <br/> `large` -> `large`       |
| `icon`                 | `icon`         | Now accepts a component, not an element (`AddIcon` instead of `<AddIcon/>`)  |
| -                      | `iconPosition` | `'left'` or `'right'`                                                        |
| `uppercase`            | -              | No longer supported                                                          |
| `loading`              | `loading`      | Same behavior                                                                |
| `disabled`             | `disabled`     | Same behavior                                                                |
| `labelStyleOverride`   | -              | Use styling API instead (see advanced styling)                               |
| `contentStyleOverride` | -              | Use styling API instead (see advanced styling)                               |
| -                      | `colorScheme`  | `'cyan'`, `'red'`, `'green'`, `'grey'`, or `'gold'`                          |
| -                      | `inverted`     | For use on dark backgrounds                                                  |

For custom styling and layouts, the new Button component supports a more component-based approach:

```tsx
// Before - custom styling
import { Button } from '@utilitywarehouse/uw-native-ui';
import { ArrowIcon } from './icons';

<Button
  mode="outlined"
  icon={<ArrowIcon />}
  labelStyleOverride={styles.buttonLabel}
  contentStyleOverride={styles.buttonContent}
  onPress={handleClick}
>
  Click me
</Button>;

// After - component composition
import { Button, ButtonText, ButtonIcon } from '@utilitywarehouse/native-ui';
import { ArrowIcon } from '@utilitywarehouse/react-native-icons';

<Button variant="outline" onPress={handleClick}>
  <ButtonIcon as={ArrowIcon} />
  <ButtonText style={styles.buttonText}>Click me</ButtonText>
</Button>;
```

For more info see the [Button](/docs/native-ui-components-button--docs) documentation.

#### `Card`

Replace all `Card` components from `@utilitywarehouse/uw-native-ui` with `@utilitywarehouse/native-ui`.

```tsx
- import { Card, Typography } from '@utilitywarehouse/uw-native-ui';
+ import { Card, Text } from '@utilitywarehouse/native-ui';

...

- <Card color="#f5f5f5" gutterBottom={2} onPress={handlePress}>
-   <Typography>Card content</Typography>
- </Card>
+ <Card colorScheme="grey" padding="large" variant="outline" style={{ marginBottom: 16 }} onPress={handlePress}>
+   <Text>Card content</Text>
+ </Card>
```

| Prop Before    | Prop After    | Values                                                         |
| -------------- | ------------- | -------------------------------------------------------------- |
| `color`        | `colorScheme` | Use `'base'`, `'grey'`, or `'purple'` instead of custom colors |
| `gutterBottom` | `style`       | Use `style={{ marginBottom: 16 }}` for spacing                 |
| `onPress`      | `onPress`     | Same behavior                                                  |
| -              | `variant`     | `'outline'`, `'filled'`, `'elevated'`, or `'dashed'`           |
| -              | `padding`     | `'large'`, `'medium'`, `'small'`, or `'none'`                  |
| -              | `surface`     | `'base'` or `'purple'`                                         |
| -              | `nested`      | `true` or `false`                                              |

For more info see the [Card](/docs/native-ui-components-card--docs) documentation.

#### `Checkbox`

Replace all `Checkbox` components from `@utilitywarehouse/uw-native-ui` with `@utilitywarehouse/native-ui`.

```tsx
- import { Checkbox, Typography } from '@utilitywarehouse/uw-native-ui';
+ import { Checkbox, CheckboxGroup } from '@utilitywarehouse/native-ui';

...

- <Checkbox
-   checked={isChecked}
-   label="Accept terms and conditions"
-   onPress={() => setIsChecked(!isChecked)}
-   gutterBottom={2}
- />
+ <Checkbox
+   value="terms"
+   checked={isChecked}
+   onChange={setIsChecked}
+   label="Accept terms and conditions"
+   style={{ marginBottom: 16 }}
+ />
```

| Prop Before    | Prop After    | Values                                               |
| -------------- | ------------- | ---------------------------------------------------- |
| `label`        | `label`       | Same behavior                                        |
| `checked`      | `checked`     | Same behavior                                        |
| `onPress`      | `onChange`    | Now receives the new state as a parameter            |
| `gutterBottom` | `style`       | Use `style={{ marginBottom: 16 }}` for spacing       |
| `disabled`     | `disabled`    | Same behavior                                        |
| `align`        | -             | No longer supported; use custom styling              |
| `reverse`      | -             | No longer supported; use component composition       |
| `mode`         | -             | No longer supported; use `Card` for button-like mode |
| -              | `value`       | Required prop for form submissions                   |
| -              | `helperText`  | Optional descriptive text for the checkbox           |
| -              | `invalidText` | Text to show when validation status is invalid       |
| -              | `validText`   | Text to show when validation status is valid         |

For multiple checkboxes, use `CheckboxGroup`:

```tsx
...

- <View>
-   <Checkbox checked={fruit.apple} label="Apple" onPress={() => toggleFruit('apple')} />
-   <Checkbox checked={fruit.banana} label="Banana" onPress={() => toggleFruit('banana')} />
-   <Checkbox checked={fruit.orange} label="Orange" onPress={() => toggleFruit('orange')} />-{' '}
- </View>
+ <CheckboxGroup value={selectedFruits} onChange={setSelectedFruits}>
+   <Checkbox value="apple" label="Apple" />
+   <Checkbox value="banana" label="Banana" />
+   <Checkbox value="orange" label="Orange" />+{' '}
+ </CheckboxGroup>

...
```

For more info see the [Checkbox](/docs/native-ui-components-checkbox--docs) documentation.

#### `IconButton`

Replace all `IconButton` components from `@utilitywarehouse/uw-native-ui` with `@utilitywarehouse/native-ui`.

```tsx
- import { IconButton } from '@utilitywarehouse/uw-native-ui';
+ import { IconButton } from '@utilitywarehouse/native-ui';
import { AddMediumIcon } from '@utilitywarehouse/react-native-icons';

...

- <IconButton icon={() => <AddMediumIcon />} color="red" onPress={handleClick} />
+ <IconButton colorScheme="red" icon={AddMediumIcon} onPress={handleClick} />
```

| Prop Before | Prop After    | Values |
| ----------- | ------------- | ------ |
| `color`     | `colorScheme` |        |

For more info see the [IconButton](/docs/native-ui-components-iconbutton--docs) documentation.

#### `Typography`

The `Typography` component doesn't map 1:1 with `@utilitywarehouse/uw-native-ui`. You can use the `Text` and `Heading` components
from `@utilitywarehouse/native-ui` instead.

```tsx
- import { Typography } from '@utilitywarehouse/uw-native-ui';
+ import { Text, Heading } from '@utilitywarehouse/native-ui';

...

- <Typography variant="h1">Heading 1</Typography>
+ <Heading size="h1">Heading 1</Heading>

- <Typography variant="body">Body text</Typography>
+ <Text>Body text</Text>
```

For more info see the [Text](/docs/native-ui-components-text--docs) and [Heading](/docs/native-ui-components-heading--docs) documentation.

#### `ThemeProvider`

```tsx
- import { ThemeProvider } from '@utilitywarehouse/uw-native-ui';
+ import { NativeUIProvider } from '@utilitywarehouse/native-ui';
```

```tsx
- <ThemeProvider theme={theme} variant={colorMode}>
+ <NativeUIProvider theme={theme} colorMode={colorMode}>
```

More info can be found in the [Getting Started](/docs/native-ui-introduction--docs#dark-mode) documentation.

### Styles

`@utilitywarehouse/uw-native-ui` uses `StyleSheet` from `react-native` for styling, whereas `@utilitywarehouse/native-ui` uses
`react-native-unitstyles` for styles. You can still use the `StyleSheet` from `react-native` with `@utilitywarehouse/native-ui` but
it is recommended to use the `createStyleSheet` method and `useStyles` hook for styling. With the `Box` component you can use
utility props for styling. See out [Styling](/docs/native-ui-guides-styling-overview--docs) documentation for more info.

#### `StyleSheet`

```tsx
- import { StyleSheet } from 'react-native';
- import { View } from '@utilitywarehouse/uw-native-ui';
+ import { Box } from '@utilitywarehouse/native-ui';
// or
+ import { styled } from '@utilitywarehouse/native-ui';

- const styles = StyleSheet.create({
-   container: {
-     backgroundColor: 'red',
-   },
- });

- <View style={styles.container}>

+ <Box bg="red" />

// or

+ const StyledBox = styled(Box, {
+   backgroundColor: 'red',
+ });
```

#### Dark Mode

lt the light colour mode is enabled. If you want to enable dark mode, you can pass the `colorMode` prop to the `NativeUIProvider` component. The two options for `colorMode` are `light` and `dark`.

```tsx
import { ColorSchemeName, useColorScheme } from 'react-native';

const App: React.FC = () => {
  const colorScheme = useColorScheme();

  return (
    <NativeUIProvider colorMode={colorScheme as ColorSchemeName}>
      <App />
    </NativeUIProvider>
  );
};
```

You can also use the `useColorMode` hook to get the current colour mode of the device.

```tsx
- import { useDarkMode } from '@utilitywarehouse/uw-native-ui';
+ import { useColorMode } from '@utilitywarehouse/native-ui';
```

Dark mode is also baked into the styling so you no longer need to use the `DynamicValue` for the colour scheme.

```tsx
- import { DynamicValue, makeDynamicStyles, Typography } from '@utilitywarehouse/uw-native-ui';
+ import { Box, Text } from '@utilitywarehouse/native-ui';

- const useDynamicStyles = makeDynamicStyles(theme => ({
-   root: {
-     backgroundColor: new DynamicValue('white', 'black');
-     margin: 20,
-   },
- }));

const MyComponent = () => {
- const styles = useDynamicStyles();
+ const { colorMode } = useColorMode();

  return (
-    <View style={styles.root}>
+    <Box
+      backgroundColor={colorMode === 'light' ? 'white' : 'black'}
+      margin={20},
+    >
}

-      <Typography>{title}</Typography>
+      <Text>{title}</Text>
-    </View>
+    </Box>
  );
}
```

### Fonts

If you have followed the [getting started steps](/docs/native-ui-introduction--docs#additional-packages) and are using either
`npx react-native-asset` or `expo-font` with `expo-xml-font` then you can use the `fontFamily` property like you would on the web
when writing styles.

```tsx
const styles = StyleSheet.create({
  title: {
    color: '#20232a',
    textAlign: 'center',
-   fontFamily: 'Aeonik-Bold',
+   fontFamily: 'Aeonik',
+   fontWeight: '700',
    fontSize: 30,
  },
  body: {
-   fontFamily: 'WorkSans-Regular',
+   fontFamily: 'Work Sans',
+   fontWeight: '400',
    fontSize: 16,
  }
});
```

For more info see the [Fonts](/docs/native-ui-guides-styling-fonts--docs) documentation.

### Colours

Please see the colour system [migration docs](/docs/colour-system-migration--docs) for more info on how to migrate your colours.

## Known Issues

### `TypeError: Cannot read property 'x' of undefined`

For the most part both libraries should work together but there may be some issues with the `gluestack-ui` and `react-native-paper`
and their respective themes. When using both libraries together, specifically using `uw-native-ui` components inside of `native-ui` components
you may encounter the following error:

```console
TypeError: Cannot read property 'x' of undefined
```

If you encounter this issue, you can try to use the `ThemeProvider` from `@utilitywarehouse/uw-native-ui` and wrap the `uw-native-ui`
component with it. This should fix the issue.

## Support

If you notice any other issues, or have any questions please raise an issue on the respective GitHub repository, contact the Design Systems team on Slack
on the channels [#help-design-systems](https://utilitywarehouse.slack.com/archives/C04MKBQ34PJ) or [#tool-native-ui](https://utilitywarehouse.slack.com/archives/C03JP9CV77H).
